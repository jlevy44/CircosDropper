import pandas as pd, cPickle as pickle

unouts = """PAC2_0.316-PAC2_0.326_5.unout  PAC2_0.316-PAC4GC.650_5.unout
PAC2_0.316-PAC2_0.327_5.unout  PAC2_0.316-PAC4GC.651_5.unout
PAC2_0.316-PAC2_0.328_5.unout  PAC2_0.316-PAC4GC.652_5.unout
PAC2_0.316-PAC2_0.329_5.unout  PAC2_0.316-PAC4GC.653_5.unout
PAC2_0.316-PAC2_0.330_5.unout  PAC2_0.316-PAC4GC.654_5.unout
PAC2_0.316-PAC2_0.331_5.unout  PAC2_0.316-PAC4GC.655_5.unout
PAC2_0.316-PAC2_0.332_5.unout  PAC2_0.316-PAC4GC.656_5.unout
PAC2_0.316-PAC2_0.333_5.unout  PAC2_0.316-PAC4GC.657_5.unout
PAC2_0.316-PAC2_0.334_5.unout  PAC2_0.316-PAC4GC.658_5.unout
PAC2_0.316-PAC2_0.335_5.unout  PAC2_0.316-PAC4GC.659_5.unout
PAC2_0.316-PAC2_0.336_5.unout  PAC2_0.316-PAC4GC.660_5.unout
PAC2_0.316-PAC2_0.337_5.unout  PAC2_0.316-PAC4GC.661_5.unout
PAC2_0.316-PAC2_0.338_5.unout  PAC2_0.316-PAC4GC.662_5.unout
PAC2_0.316-PAC2_0.339_5.unout  PAC2_0.316-PAC4GC.663_5.unout
PAC2_0.316-PAC2_0.340_5.unout  PAC2_0.316-PAC4GC.664_5.unout
PAC2_0.316-PAC2_0.341_5.unout  PAC2_0.316-PAC4GC.665_5.unout
PAC2_0.316-PAC2_0.342_5.unout  PAC2_0.316-PAC4GC.666_5.unout
PAC2_0.316-PAC2_0.343_5.unout  PAC2_0.316-PAC4GC.667_5.unout
PAC2_0.316-PAC2_0.344_5.unout  PAC2_0.316-PAC4GC.668_5.unout
PAC2_0.316-PAC2_0.345_5.unout  PAC2_0.316-PAC4GC.669_5.unout
PAC2_0.316-PAC2_0.346_5.unout  PAC2_0.316-PAC4GC.670_5.unout
PAC2_0.316-PAC2_0.347_5.unout  PAC2_0.316-PAC4GC.671_5.unout
PAC2_0.316-PAC2_0.348_5.unout  PAC2_0.316-PAC4GC.672_5.unout
PAC2_0.316-PAC2_0.349_5.unout  PAC2_0.316-PAC4GC.673_5.unout
PAC2_0.316-PAC2_0.350_5.unout  PAC2_0.316-PAC4GC.674_5.unout
PAC2_0.316-PAC2_0.351_5.unout  PAC2_0.316-PAC4GC.675_5.unout
PAC2_0.316-PAC2_0.352_5.unout  PAC2_0.316-PAC4GC.676_5.unout
PAC2_0.316-PAC2_0.353_5.unout  PAC2_0.316-PAC4GC.677_5.unout
PAC2_0.316-PAC2_0.354_5.unout  PAC2_0.316-PAC4GC.678_5.unout
PAC2_0.316-PAC2_0.355_5.unout  PAC2_0.316-PAC4GC.679_5.unout
PAC2_0.316-PAC2_0.356_5.unout  PAC2_0.316-PAC4GC.680_5.unout
PAC2_0.316-PAC2_0.357_5.unout  PAC2_0.316-PAC4GC.681_5.unout
PAC2_0.316-PAC2_0.358_5.unout  PAC2_0.316-PAC4GC.682_5.unout
PAC2_0.316-PAC2_0.359_5.unout  PAC2_0.316-PAC4GC.683_5.unout
PAC2_0.316-PAC2_0.360_5.unout  PAC2_0.316-PAC4GC.684_5.unout
PAC2_0.316-PAC2_0.361_5.unout  PAC2_0.316-PAC4GC.685_5.unout
PAC2_0.316-PAC2_0.362_5.unout  PAC2_0.316-PAC4GC.686_5.unout
PAC2_0.316-PAC2_0.363_5.unout  PAC2_0.316-PAC4GC.687_5.unout
PAC2_0.316-PAC2_0.364_5.unout  PAC2_0.316-PAC4GC.688_5.unout
PAC2_0.316-PAC2_0.365_5.unout  PAC2_0.316-PAC4GC.689_5.unout
PAC2_0.316-PAC2_0.366_5.unout  PAC2_0.316-PAC4GC.690_5.unout
PAC2_0.316-PAC2_0.367_5.unout  PAC2_0.316-PAC4GC.691_5.unout
PAC2_0.316-PAC2_0.368_5.unout  PAC2_0.316-PAC4GC.692_5.unout
PAC2_0.316-PAC2_0.369_5.unout  PAC2_0.316-PAC4GC.693_5.unout
PAC2_0.316-PAC2_0.370_5.unout  PAC2_0.316-PAC4GC.694_5.unout
PAC2_0.316-PAC2_0.371_5.unout  PAC2_0.316-PAC4GC.695_5.unout
PAC2_0.316-PAC2_0.372_5.unout  PAC2_0.316-PAC4GC.696_5.unout
PAC2_0.316-PAC2_0.373_5.unout  PAC2_0.316-PAC4GC.697_5.unout
PAC2_0.316-PAC2_0.374_5.unout  PAC2_0.316-PAC4GC.698_5.unout
PAC2_0.316-PAC2_0.375_5.unout  PAC2_0.316-PAC4GC.699_5.unout
PAC2_0.316-PAC2_0.376_5.unout  PAC2_0.316-PAC4GC.700_5.unout
PAC2_0.316-PAC2_0.377_5.unout  PAC2_0.316-PAC4GC.701_5.unout
PAC2_0.316-PAC2_0.378_5.unout  PAC2_0.316-PAC4GC.702_5.unout
PAC2_0.316-PAC2_0.379_5.unout  PAC2_0.316-PAC4GC.703_5.unout
PAC2_0.316-PAC2_0.380_5.unout  PAC2_0.316-PAC4GC.704_5.unout
PAC2_0.316-PAC2_0.381_5.unout  PAC2_0.316-PAC4GC.705_5.unout
PAC2_0.316-PAC2_0.460_5.unout  PAC2_0.316-PAC4GC.706_5.unout
PAC2_0.316-PAC4GC.001_5.unout  PAC2_0.316-PAC4GC.707_5.unout
PAC2_0.316-PAC4GC.002_5.unout  PAC2_0.316-PAC4GC.708_5.unout
PAC2_0.316-PAC4GC.003_5.unout  PAC2_0.316-PAC4GC.728.pre.BhD_5.unout
PAC2_0.316-PAC4GC.004_5.unout  PAC2_0.316-PAC4GC.728.pre.BhS_5.unout
PAC2_0.316-PAC4GC.009_5.unout  PAC2_0.316-PAC4GC.729.pre.BhD_5.unout
PAC2_0.316-PAC4GC.010_5.unout  PAC2_0.316-PAC4GC.729.pre.BhS_5.unout
PAC2_0.316-PAC4GC.011_5.unout  PAC2_0.316-PAC4GC.730.pre.BhD_5.unout
PAC2_0.316-PAC4GC.012_5.unout  PAC2_0.316-PAC4GC.730.pre.BhS_5.unout
PAC2_0.316-PAC4GC.646_5.unout  PAC2_0.316-PAC4GC.731.pre.BhD_5.unout
PAC2_0.316-PAC4GC.647_5.unout  PAC2_0.316-PAC4GC.731.pre.BhS_5.unout
PAC2_0.316-PAC4GC.648_5.unout  PAC2_0.316-PAC4GC.649_5.unout"""
acceptable_species = """672
687
655
668
a
a
352
a
360
700
a
675
680
a
703
a
354
326
347
365
a
a
a
a
707
667
697
682
702
676
704
677
701
686
334
329
345
348
361
372
a
338
a
a
357
342
376
648
657
664
650
a
647
660
683
a
679
a
355
a
349
340
696
368
460
344
a
688
656
670
685
689
706
674
a
a
a
a
a
363
a
353
359
362
366
375
371
692
a
659
662
705
691
661
379
364
343
337
a
a
678
666
373
693
654
649
a
651
658
a
690
341
336
333
369
327
330
350
377
a
671
a
665
694
698
684
695
663
652
653
699"""

unouts = {unout.replace('.unout','')[unout.replace('.unout','').rfind('.')+1:unout.replace('.unout','').rfind('_')]:unout for unout in unouts.replace('\n',' ').split()}
acceptable_species = set([line for line in acceptable_species.splitlines() if line != 'a'])

for species in acceptable_species:
    del unouts[species]

for species in unouts.keys():
    if 'Bh' in species or int(species) in range(13):
        del unouts[species]

print unouts.values()

if 0:
    a = pd.read_csv('correspondence.csv')
    #print a
    b={a['TreeName'][i]:a['strain'][i] for i in range(len(a)) if a['TreeName'][i] != 'a'}
    c = {'Bhyb001':'ABR113D','Bhyb003':'Bd28D','Bhyb009':'Bhyb36D','Bhyb011':'Bhyb30D'}
    b.update(c)
    distTree = "(Bdist686:0.00114545,Bdist683:0.00110971,((Bdist333:0.00198568,((Bdist679:0.00158850,(Bdist695:0.00128191,(Bdist698:0.00091942,Bdist694:0.00092186)1:0.00056407)1:0.00043976)1:0.00030834,(((Bdist341:0.00000775,Bdist348:0.00059265)1:0.00109465,(Bdist349:0.00249824,Bdist329:0.00183840)1:0.00053565)1:0.00034406,((Bdist700:0.00123440,Bdist680:0.00131535)1:0.00042510,((Bdist690:0.00073667,(Bdist652:0.00000803,Bdist684:0.00000265)1:0.00059659)1:0.00120747,(Bdist671:0.00118775,(Bdist692:0.00000053,Bdist691:0.00000108)1:0.00112177)1:0.00123037)1:0.00024529)1:0.00033515)1:0.00049522)1:0.00065281)1:0.00118348,((Bdist656:0.00141841,(Bdist355:0.00123439,(Bdist689:0.00000202,Bdist350:0.00001601)1:0.00106466)1:0.00061814)1:0.00229825,((Bdist314:0.00000001,Bdist361:0.00004784)1:0.00112607,((Bdist460:0.00000087,Bdist668:0.00000188)1:0.00160547,(Bdist353:0.00239517,((Bdist664:0.00132046,Bdist342:0.00106620)0:0.00038014,(((Bdist654:0.00000001,Bdist649:0.00000001)1:0.00000001,(Bdist334:0.00000059,(Bdist338:0.00084989,Bdist365:0.00086977)1:0.00014640)1:0.00000041)1:0.00097379,((((Bdist330:0.00000138,Bdist701:0.00000050)1:0.00026069,(Bdist651:0.00000001,Bdist354:0.00051945)1:0.00022431)1:0.00056494,(Bdist368:0.00240982,Bdist650:0.00076700)1:0.00043187)1:0.00025307,(((Bdist703:0.00050520,(Bdist363:0.00003157,Bdist357:0.00020774)1:0.00043339)1:0.00076284,(Bdist705:0.00110150,(Bdist659:0.00130719,((Bdist658:0.00000001,Bdist352:0.00088650)1:0.00067025,(Bdist372:0.00116260,(Bdist666:0.00045117,Bdist359:0.00089140)1:0.00036396)1:0.00060252)1:0.00050172)1:0.00035509)1:0.00037733)1:0.00033224,(((Bdist699:0.00007803,Bdist693:0.00013725)1:0.00082519,(Bdist678:0.00051167,(Bdist376:0.00024481,Bdist345:0.00009822)1:0.00127943)1:0.00058505)1:0.00032774,((Bdist362:0.00130224,(Bdist653:0.00052659,(Bdist665:0.00072730,(((Bdist662:0.00000011,Bdist661:0.00000037)1:0.00042872,(Bdist657:0.00000062,Bdist660:0.00000049)1:0.00046244)1:0.00052725,(Bdist663:0.00068006,Bdist648:0.00042224)1:0.00042096)1:0.00029258)1:0.00028638)1:0.00056572)1:0.00022041,(Bdist670:0.00101876,((Bdist667:0.00109439,Bdist677:0.00142019)1:0.00042078,(((Bdist369:0.00136127,Bdist697:0.00122524)1:0.00035648,(Bdist707:0.00113714,Bdist655:0.00106195)1:0.00028104)0:0.00023238,((Bdist337:0.00153362,((Bdist685:0.00129595,(Bdist675:0.00115968,Bdist687:0.00119193)1:0.00045510)0:0.00018894,(Bdist344:0.00341681,Bdist672:0.00111525)1:0.00045958)1:0.00038924)0:0.00017985,(((Bdist706:0.00000001,Bdist682:0.00000036)1:0.00127972,(Bdist336:0.00118556,Bdist326:0.00132212)1:0.00052179)1:0.00023321,((Bdist327:0.00152057,((Bdist360:0.00124422,(Bdist373:0.00132105,(Bdist371:0.00003281,Bdist366:0.00006187)1:0.00087482)1:0.00036127)1:0.00025489,(Bdist702:0.00119894,(Bdist379:0.00125143,Bdist343:0.00118849)1:0.00043793)0:0.00020964)0:0.00020913)0:0.00021740,((Bdist347:0.00126908,Bdist688:0.00115834)0:0.00034235,(((Bdist377:0.00134237,Bdist375:0.00110663)1:0.00030699,(Bdist676:0.00110529,(Bdist704:0.00000328,Bdist696:0.00000302)1:0.00100297)1:0.00039690)0:0.00018232,((Bdist674:0.00000149,Bdist340:0.00000505)1:0.00113431,(Bdist364:0.00125302,Bdist647:0.00130294)1:0.00028660)0:0.00017999)0:0.00017744)0:0.00020289)0:0.00015455)0:0.00022583)0:0.00022512)0:0.00012312)1:0.00038407)1:0.00142081)1:0.00034000)1:0.00032804)1:0.00030359)1:0.00030620)0:0.00025971)1:0.00057454)1:0.00049582)1:0.00076080)1:0.00288455)1:0.00089415)1:0.00516762);"
    distTree = "(Bdist686:0.00101890,Bdist683:0.00102349,(Bhyb009:0.01494227,(((Bdist656:0.00104543,(Bdist355:0.00092828,(Bdist689:0.00000072,Bdist350:0.00001564)1:0.00079129)1:0.00061345)1:0.00242102,((((Bdist349:0.00231863,Bdist329:0.00180176)1:0.00042260,((Bdist341:0.00004022,Bdist348:0.00058270)1:0.00110787,(Bdist680:0.00118501,((Bdist671:0.00093857,(Bdist692:0.00000079,Bdist691:0.00000118)1:0.00073526)1:0.00103142,(Bdist700:0.00096958,(Bdist690:0.00054394,(Bdist652:0.00000792,Bdist684:0.00000365)1:0.00056181)1:0.00086656)0:0.00025015)0:0.00024063)1:0.00030626)0:0.00019852)1:0.00038738,((Bdist695:0.00120469,(Bdist698:0.00076325,Bdist694:0.00081359)1:0.00047752)1:0.00031745,(Bdist333:0.00191502,Bdist679:0.00126843)0:0.00027925)1:0.00022680)1:0.00062039,(Bhyb003:0.00129941,(Bhyb011:0.00224049,Bhyb001:0.00220794)1:0.00067282)1:0.00110276)1:0.00131107)1:0.00063599,((Bdist314:0.00000001,Bdist361:0.00004326)1:0.00096528,((Bdist460:0.00000105,Bdist668:0.00000240)1:0.00108573,(Bdist353:0.00211583,(((Bdist703:0.00057454,(Bdist363:0.00003185,Bdist357:0.00020057)1:0.00050801)1:0.00064183,(Bdist705:0.00102112,(Bdist659:0.00113811,((Bdist658:0.00000001,Bdist352:0.00089611)1:0.00058898,(Bdist372:0.00090421,(Bdist666:0.00037198,Bdist359:0.00084909)1:0.00046931)1:0.00031597)1:0.00048325)1:0.00033392)1:0.00027968)1:0.00025626,((((Bdist654:0.00000040,Bdist649:0.00000001)1:0.00000001,(Bdist334:0.00000081,(Bdist338:0.00084489,Bdist365:0.00082057)1:0.00014377)1:0.00000020)1:0.00091747,((((Bdist701:0.00000134,Bdist330:0.00000097)1:0.00025204,(Bdist651:0.00000047,Bdist354:0.00050860)1:0.00029995)1:0.00057182,(Bdist650:0.00091643,Bdist368:0.00205640)1:0.00032867)1:0.00019765,(((Bdist699:0.00018568,Bdist693:0.00022709)1:0.00077276,(Bdist678:0.00059555,(Bdist376:0.00023829,Bdist345:0.00009140)1:0.00104245)1:0.00042805)1:0.00034093,((Bdist653:0.00070225,(Bdist665:0.00065947,(((Bdist662:0.00000003,Bdist661:0.00000045)1:0.00053191,(Bdist657:0.00000087,Bdist660:0.00000064)1:0.00040463)1:0.00056234,(Bdist648:0.00059312,Bdist663:0.00056274)1:0.00022794)1:0.00033918)1:0.00027028)1:0.00062012,(Bdist362:0.00111155,(Bdist670:0.00095782,(((((Bdist672:0.00120704,Bdist685:0.00108018)1:0.00035027,(Bdist344:0.00313271,(Bdist687:0.00109363,Bdist675:0.00108270)1:0.00028675)1:0.00015503)1:0.00034100,(Bdist337:0.00137530,(((Bdist336:0.00091656,Bdist326:0.00105847)1:0.00054405,((Bdist379:0.00096698,Bdist343:0.00103195)1:0.00036798,((Bdist702:0.00099043,Bdist347:0.00099204)1:0.00029281,(Bdist360:0.00103755,(Bdist373:0.00119586,(Bdist371:0.00004693,Bdist366:0.00006015)1:0.00085795)1:0.00030909)1:0.00015600)1:0.00012725)1:0.00013688)1:0.00015736,((Bdist647:0.00110664,Bdist364:0.00105203)1:0.00029812,((Bdist676:0.00101542,Bdist327:0.00104995)0:0.00031581,(((Bdist706:0.00000003,Bdist682:0.00000143)1:0.00099027,(Bdist674:0.00000222,Bdist340:0.00000537)1:0.00091572)0:0.00022930,((Bdist688:0.00098804,(Bdist704:0.00000375,Bdist696:0.00000068)1:0.00090639)0:0.00025586,(Bdist377:0.00106889,Bdist375:0.00094245)1:0.00021729)0:0.00014733)0:0.00010860)0:0.00015031)1:0.00016682)1:0.00019563)1:0.00020558)0:0.00016883,((Bdist369:0.00115069,Bdist697:0.00116298)0:0.00029763,(Bdist707:0.00091664,Bdist677:0.00111856)1:0.00029744)0:0.00012622)0:0.00013081,(Bdist655:0.00101316,Bdist667:0.00103455)0:0.00021974)1:0.00034401)1:0.00133790)1:0.00022733)1:0.00039754)1:0.00029939)1:0.00026144)1:0.00022918,(Bdist342:0.00095599,Bdist664:0.00112252)1:0.00031116)1:0.00020204)1:0.00068402)1:0.00047077)1:0.00067685)1:0.00299515)1:0.00127065)1:0.00365263);"
    for k in b:
        distTree = distTree.replace(k,b[k])

    pickle.dump(b,open('reverseDictionary.p','wb'))

    print distTree.replace(')1',')').replace(')0',')')
    #print b